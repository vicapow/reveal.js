<!doctype html>
<html lang="en">

	<head>
		<meta charset="utf-8">

		<title>Mapping with Small Modules</title>

		<meta name="description" content="Using the Unix/Node philosophy of small modules to build a mapping visualization library.">
		<meta name="author" content="Victor Powell">

		<meta name="apple-mobile-web-app-capable" content="yes">
		<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">

		<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">

		<link rel="stylesheet" href="css/reveal.css">
		<link rel="stylesheet" href="css/theme/serif.css" id="theme">

		<!-- Code syntax highlighting -->
		<link rel="stylesheet" href="lib/css/zenburn.css">

		<style>
		.reveal section img {
			border: none;
		}
		</style>

		<!-- Printing and PDF exports -->
		<script>
			var link = document.createElement( 'link' );
			link.rel = 'stylesheet';
			link.type = 'text/css';
			link.href = window.location.search.match( /print-pdf/gi ) ? 'css/print/pdf.css' : 'css/print/paper.css';
			document.getElementsByTagName( 'head' )[0].appendChild( link );
		</script>

		<!--[if lt IE 9]>
		<script src="lib/js/html5shiv.js"></script>
		<![endif]-->
	</head>

	<body>

		<div class="reveal">

			<!-- Any section element inside of this container is displayed as a slide -->
			<div class="slides">
				<section>
					<h1>Mapping with Small Modules</h1>
					<h3>A WaffleJS talk</h3>
					<p>
						<small>Created by Victor Powell / <a href="http://twitter.com/vicapow">@vicapow</a></small>
					</p>
				</section>

				<section data-markdown>
					[react-map-gl](http://uber.github.io/react-map-gl/#/). Wrapper around [MapboxGL-js](https://www.mapbox.com/mapbox-gl-js/examples/)
				</section>

				<section data-markdown>
			     ![](https://cloud.githubusercontent.com/assets/499192/11028165/49f41da2-86bc-11e5-85eb-9279621ef971.png)
				</section>

				<section data-markdown>
					### react-map-gl
					Goals
					 * Drop in solution for React apps that want maps. (Lots of React Apps at Uber.)
					 * Give it a pure/stateless API.
				</section>

				<section data-markdown>
					![](img/desktop.png)
					[live demo](http://vicapow.github.io/react-map-gl-stack-gl-overlay-example/)
				</section>

				<section>
					<pre><code>&lt;MapGL
  width={700}
  height={450}
  latitude={37.78}
  longitude={-122.45}
  zoom={11}
  mapStyle={mapStyle} /&gt;</code></pre>
				</section>

				<section>
					<pre><code>&lt;MapGL {...viewport} mapStyle={mapStyle}
  onChangeViewport={this.onChangeViewport}/&gt;</code></pre>
				</section>

				<section>
					<p>Stateless</p>
					<pre><code>onChangeViewport: function(viewport) {
  if (viewport.zoom < 10) {
    // Clamp zoom level to 10
    return;
  }
  this.setState({viewport});
}</code></pre>
				</section>

				<section>
				viewport + mercator projection:
					pixels <-> lng,lat
				</section>

				<section>
				<pre><code>var Mercator = require('viewport-mercator-project');
var mercator = Mercator(viewport);
var pixel = mercator.project([-122.45, 37.77]);
var lngLat = mercator.unproject(pixel);
</code></pre>
				</section>

				<section>
				<pre><code>function MyOverlay() {
  var {width, height} = this.props.viewport;
  var mercator = Mercator(viewport);
  var location = [-122.45, 37.77]; // San Francisco
  return &lt;svg width={width} height={height}&gt;
    // Draw a dot on top of San Francisco
    &lt;circle r="10" transform={`translate(${mercator(location)})`} /&gt;
  &lt;/svg&gt;;
}
</code></pre>
				</section>

				<section data-markdown>
				  ## Why create a new module?
				</section>

				<section data-markdown>
					## Example: [d3-request](https://github.com/d3/d3-request)
					As it's own module, with its own semver, we wouldn't need to worry about breaking API changes to it if we didn't use it in our code.
				</section>

				<section data-markdown>
					### Without small modules
					Consumer: I upgraded to D3 to v4 to fix an issue with shapes in my project and now my http requests are failing!
					### With small modules
					Consumer: I upgraded d3-shape to fix an issue with SVG shapes in my project and nothing else happened.
				</section>

				<section data-markdown>
					# Small Modules
					Collect code into small, resuable chunks.
				</section>

				<section>
					<table>
						<thead>
							<tr>
								<th>small modules</th><th>mono libraries</th>
							</tr>
						</thead>
						<tbody>
							<tr>
								<td>small builds</td><td>larger builds</td>
							</tr>
							<tr>
								<td>mistakes are ok!</td><td>get it right!</td>
							</tr>
							<tr>
								<td>isolated</td><td>systemic</td>
							</tr>
							<tr>
								<td>multiple repos</td><td>single repo</td>
							</tr>
							<tr>
								<td>can cause cascaded commits</td><td>always single commit</td>
							</tr>
							<tr>
								<td>docs in each repo</td><td>docs in one repo</td>
							</tr>
							<tr>
								<td>decouples unrelated code</td><td>cohension of all code</td>
							</tr>
							<tr>
								<td>reuse</td><td>reinvention</td>
							</tr>
							<tr>
								<td>optionality</td><td>lockin</td>
							</tr>
						</tbody>
					</table>
				</section>

				<section>
				  <h4>Example projects</h4>
					<table>
						<thead>
							<tr>
								<th>small modules</th><th>mono frameworks</th>
							</tr>
						</thead>
						<tbody>
							<tr>
								<td>D3 v4</td><td>jQuery</td>
							</tr>
							<tr>
								<td>React</td><td>Ember</td>
							</tr>
							<tr>
								<td>stack.gl</td><td>Three.js</td>
							</tr>
						</tbody>
					</table>
				</section>

				<section data-markdown>
					### Small modules and "antifragility"
					![](img/antifragile.jpg)

					Nassim Nicholas Taleb
				</section>

				<section data-markdown>
					Fragile - You stress it and it breaks.
					
					Robust - You stress it and it doesn't break.
					
					Antifragile - You stress it and it gets better.
				</section>

				<section>
					Reusable overlays can be created that don't need to directly require react-map-gl or mapbox. They can even use the overlays without being interactive. Just need to make sure to give it proper viewport coordinates.
				</section>

				<section data-markdown>
					## Further reading
					[Module Best Practices](https://github.com/mattdesl/module-best-practices) - By Matt DesLauriers
					
					[Unix Philosophy and Node.JS](http://blog.izs.me/post/48281998870/unix-philosophy-and-nodejs) - Isaac Z. Schlueter
					
					[How I Write Modules](http://substack.net/how_I_write_modules) - James Holiday
				</section>

				<section>
					<img src="img/uber-logo.png" />
				</section>

				<section data-markdown>
					## Thank you
				</section>

			</div>

		</div>

		<script src="lib/js/head.min.js"></script>
		<script src="js/reveal.js"></script>

		<script>

			// Full list of configuration options available at:
			// https://github.com/hakimel/reveal.js#configuration
			Reveal.initialize({
				controls: true,
				progress: true,
				history: true,
				center: true,

				transition: 'slide', // none/fade/slide/convex/concave/zoom

				// Optional reveal.js plugins
				dependencies: [
					{ src: 'lib/js/classList.js', condition: function() { return !document.body.classList; } },
					{ src: 'plugin/markdown/marked.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
					{ src: 'plugin/markdown/markdown.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
					{ src: 'plugin/highlight/highlight.js', async: true, callback: function() { hljs.initHighlightingOnLoad(); } },
					{ src: 'plugin/zoom-js/zoom.js', async: true },
					{ src: 'plugin/notes/notes.js', async: true }
				]
			});

		</script>

	</body>
</html>
